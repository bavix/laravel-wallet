deptrac:
  paths:
    - ./src
  layers:
    - name: Legacy
      collectors:
        - type: classLike
          value: ^Bavix\\.*\\Objects\\Cart$

    - name: Contract
      collectors:
        - type: classLike
          value: ^Bavix\\Wallet\\Interfaces\\.*
        - type: classLike
          value: ^Bavix\\Wallet\\External\\Contracts\\.*
        - type: classLike
          value: ^Bavix\\Wallet\\External\\Dto\\.*

    - name: Api
      collectors:
        - type: classLike
          value: ^Bavix\\Wallet\\External\\Api\\.*Interface$

    - name: ApiQuery
      collectors:
        - type: classLike
          value: ^Bavix\\Wallet\\External\\Api\\.*Query$

    - name: ApiHandler
      collectors:
        - type: classLike
          value: ^Bavix\\Wallet\\External\\Api\\.*Handler$

    - name: UI
      collectors:
        - type: classLike
          value: ^Bavix\\.*\\Traits\\.*

    - name: UIException
      collectors:
        - type: classLike
          value: ^Illuminate\\Database\\Eloquent\\ModelNotFoundException$
        - type: classLike
          value: ^Bavix\\Wallet\\Exceptions\\.*

    # internal
    - name: InternalException
      collectors:
        - type: classLike
          value: ^Bavix\\.*\\Internal\\Exceptions\\.*

    - name: InternalListener
      collectors:
        - type: classLike
          value: ^Bavix\\.*\\Internal\\Listeners\\.*

    - name: Event
      collectors:
        - type: classLike
          value: ^Bavix\\.*\\Internal\\Events\\.*Event$

    - name: EventInterface
      collectors:
        - type: classLike
          value: ^Bavix\\.*\\Internal\\Events\\.*EventInterface$

    - name: Dto
      collectors:
        - type: classLike
          value: ^Bavix\\.*\\Internal\\Dto\\.*Dto$

    - name: DtoInterface
      collectors:
        - type: classLike
          value: ^Bavix\\.*\\Internal\\Dto\\.*DtoInterface$

    - name: AssemblerDto
      collectors:
        - type: classLike
          value: ^Bavix\\.*\\Internal\\Assembler\\.*DtoAssembler$

    - name: AssemblerDtoInterface
      collectors:
        - type: classLike
          value: ^Bavix\\.*\\Internal\\Assembler\\.*DtoAssemblerInterface$

    - name: QueryInterface
      collectors:
        - type: classLike
          value: ^Bavix\\.*Internal\\Query\\.*QueryInterface$

    - name: Query
      collectors:
        - type: classLike
          value: ^Bavix\\.*Internal\\Query\\.*Query$

    - name: RepositoryInterface
      collectors:
        - type: classLike
          value: ^Bavix\\.*Internal\\Repository\\.*RepositoryInterface$

    - name: Repository
      collectors:
        - type: classLike
          value: ^Bavix\\.*Internal\\Repository\\.*Repository$

    - name: Transform
      collectors:
        - type: classLike
          value: ^Bavix\\.*Internal\\Transform\\.*DtoTransformer$

    - name: TransformInterface
      collectors:
        - type: classLike
          value: ^Bavix\\.*Internal\\Transform\\.*DtoTransformerInterface$

    - name: Infra
      collectors:
        - type: classLike
          value: ^Bavix\\.*Internal\\Service\\.*Service$

    - name: ServiceDecorator
      collectors:
        - type: classLike
          value: ^Bavix\\.*Decorator\\.*Decorator

    # contracts
    - name: Model
      collectors:
        - type: classLike
          value: ^Bavix\\.*Models\\Transaction$
        - type: classLike
          value: ^Bavix\\.*Models\\Transfer$
        - type: classLike
          value: ^Bavix\\.*Models\\Wallet$

    - name: Service
      collectors:
        - type: classLike
          value: ^Bavix\\.*Services\\.*Service$

    - name: ServiceInterface
      collectors:
        - type: classLike
          value: ^Bavix\\.*Service\\.*ServiceInterface$
        - type: classLike
          value: ^Bavix\\.*Services\\.*ServiceInterface$

    # framework
    - name: EloquentModel
      collectors:
        - type: classLike
          value: ^Illuminate\\Database\\Eloquent\\Model$

    - name: Config
      collectors:
        - type: classLike
          value: ^Illuminate\\Config\\Repository$

    - name: Cache
      collectors:
        - type: classLike
          value: ^Illuminate\\Contracts\\Cache\\Repository$

  ruleset:
    Contract:
      - InternalException
      - DtoInterface
      - UIException
      - Model
      - EloquentModel

    ApiQuery:
      - Api
      - Model
      - Contract
      - ServiceInterface

    Api:
      - Model
      - Contract
      - InternalException

    ApiHandler:
      - Api
      - Model
      - ApiQuery
      - Contract
      - ServiceInterface
      - InternalException

    UI:
      - AssemblerDtoInterface # delete as soon as possible
      - InternalException
      - ServiceInterface
      - UIException
      - Contract
      - Model
      - EloquentModel
      - Legacy # delete as soon as possible

    UIException:
      - InternalException

    Infra:
      - InternalException
      - ServiceInterface
      - EventInterface
      - Config
      - Cache

    ServiceDecorator:
      - InternalException
      - ServiceInterface

    EventInterface:
    Event:
      - EventInterface

    DtoInterface:
      - Contract
    Dto:
      - DtoInterface
      - Contract

    Model:
      - AssemblerDtoInterface
      - InternalException
      - ServiceInterface
      - EloquentModel
      - UIException
      - Contract
      - Legacy
      - UI

    TransformInterface:
      - DtoInterface
    Transform:
      - TransformInterface
      - DtoInterface

    QueryInterface:
    Query:
      - QueryInterface

    RepositoryInterface:
      - InternalException
      - QueryInterface
      - DtoInterface
      - Model
    Repository:
      - RepositoryInterface
      - TransformInterface
      - InternalException
      - ServiceInterface # json service only
      - QueryInterface
      - DtoInterface
      - UIException
      - Model

    InternalListener:
      - ServiceInterface

    ServiceInterface:
      - InternalException
      - EventInterface
      - EloquentModel
      - DtoInterface
      - UIException
      - Contract
      - Model
    Service:
      - AssemblerDtoInterface
      - RepositoryInterface
      - InternalException
      - ServiceInterface
      - EloquentModel
      - DtoInterface
      - UIException
      - Contract
      - Model

    AssemblerDtoInterface:
      - EloquentModel
      - DtoInterface
      - Contract
    AssemblerDto:
      - AssemblerDtoInterface
      - QueryInterface
      - ServiceInterface # UUID
      - EloquentModel
      - DtoInterface
      - Contract
      - Dto

    Legacy:
      - InternalException
      - ServiceInterface
      - DtoInterface
      - Contract
      - Dto # Cart from objects
